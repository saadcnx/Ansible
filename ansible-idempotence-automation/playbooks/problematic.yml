---
- name: Problematic Non-Idempotent Tasks
  hosts: local
  become: yes
  
  tasks:
    # Problem 1: Using shell/command without proper conditions
    - name: Add line to file (problematic)
      shell: echo "backup_enabled=true" >> /etc/myapp/app.conf
      
    # Problem 2: Creating files with timestamps
    - name: Create backup file (problematic)
      shell: cp /etc/myapp/app.conf /etc/myapp/app.conf.backup.$(date +%Y%m%d_%H%M%S)
      
    # Problem 3: Unconditional service restart
    - name: Restart service (problematic)
      shell: systemctl restart nginx
      
    # Problem 4: Using command without changed_when
    - name: Check disk space (problematic)
      command: df -h
      
    # Problem 5: Modifying files without backup
    - name: Modify config (problematic)
      shell: sed -i 's/debug=false/debug=true/' /etc/myapp/app.conf
